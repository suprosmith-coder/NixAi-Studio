<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
  <title>Cyanix AI ¬∑ Studio | NixAi</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- ===== FIREBASE SDK (MODULAR) ===== -->
  <script type="importmap">
    {
      "imports": {
        "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js",
        "firebase/analytics": "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js"
      }
    }
  </script>

  <style>
    /* ------------------------------
       CYANIX STUDIO ‚Äì‚Äì GLOBAL STYLES
       (preserved & extended with animations)
    ------------------------------ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      background-color: #03070a;
      background-image: 
        radial-gradient(circle at 15% 30%, rgba(0, 255, 255, 0.03) 0%, transparent 25%),
        radial-gradient(circle at 85% 70%, rgba(0, 200, 255, 0.04) 0%, transparent 30%),
        linear-gradient(145deg, #000408 0%, #0a1015 100%);
      min-height: 100vh;
      color: #e2f3ff;
      line-height: 1.5;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('data:image/svg+xml,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="1" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23noise)" opacity="0.025"/></svg>');
      pointer-events: none;
      z-index: 999;
      opacity: 0.3;
    }

    /* Auth container ‚Äì only Google sign-in */
    .auth-container {
      width: 100%;
      max-width: 440px;
      background: rgba(8, 20, 28, 0.8);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(0, 255, 255, 0.25);
      border-radius: 48px;
      padding: 48px 32px;
      box-shadow: 0 30px 50px rgba(0,0,0,0.7), 0 0 0 1px rgba(0,255,255,0.2) inset, 0 0 40px rgba(0,255,255,0.2);
      z-index: 100;
      text-align: center;
      animation: fadeInUp 0.8s ease;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .auth-header i {
      font-size: 64px;
      color: #00ffff;
      text-shadow: 0 0 30px cyan;
      margin-bottom: 16px;
    }

    .auth-header h2 {
      font-size: 32px;
      font-weight: 800;
      background: linear-gradient(135deg, #b0ffff, #00ffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .google-btn {
      background: rgba(0, 255, 255, 0.1);
      border: 2px solid cyan;
      border-radius: 60px;
      padding: 16px 32px;
      font-size: 20px;
      font-weight: 600;
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      transition: 0.3s;
      margin: 32px 0 16px;
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
    }

    .google-btn:hover {
      background: cyan;
      color: black;
      transform: scale(1.05);
      box-shadow: 0 0 40px cyan;
    }

    /* Onboarding */
    .onboarding-container {
      width: 100%;
      max-width: 520px;
      background: rgba(8, 20, 28, 0.8);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(0, 255, 255, 0.25);
      border-radius: 48px;
      padding: 40px 32px;
      box-shadow: 0 30px 50px rgba(0,0,0,0.7);
      animation: fadeInUp 0.8s ease;
    }

    /* Dashboard */
    .dashboard {
      display: grid;
      width: 100%;
      max-width: 1600px;
      padding: 24px;
      gap: 24px;
      grid-template-columns: 280px 1fr 300px;
      height: 95vh;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .side-col {
      background: rgba(8, 20, 28, 0.6);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(0, 255, 255, 0.18);
      border-radius: 40px;
      padding: 28px 16px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      box-shadow: 0 20px 35px -10px black;
      transition: all 0.3s;
    }

    .side-col:hover {
      border-color: rgba(0,255,255,0.4);
      box-shadow: 0 0 30px rgba(0,255,255,0.1);
    }

    .feature-btn {
      background: transparent;
      border: 1px solid rgba(0,255,255,0.2);
      border-radius: 60px;
      padding: 16px 20px;
      color: #b3ffff;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 16px;
      transition: 0.2s;
      cursor: pointer;
      width: 100%;
      backdrop-filter: blur(5px);
    }

    .feature-btn i {
      font-size: 24px;
      color: #00ffff;
      width: 32px;
      transition: 0.2s;
    }

    .feature-btn:hover, .feature-btn.active {
      background: rgba(0, 255, 255, 0.15);
      border-color: cyan;
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
      color: white;
      transform: translateX(6px);
    }

    .center-col {
      background: rgba(8, 20, 28, 0.5);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(0, 255, 255, 0.18);
      border-radius: 40px;
      padding: 28px 24px;
      overflow-y: auto;
      box-shadow: 0 20px 35px -10px black;
      transition: all 0.3s;
    }

    .right-col {
      gap: 16px;
    }

    .user-card {
      background: rgba(0, 255, 255, 0.05);
      border: 1px solid rgba(0,255,255,0.2);
      border-radius: 40px;
      padding: 24px 20px;
      text-align: center;
    }

    .user-avatar {
      font-size: 70px;
      color: cyan;
      margin-bottom: 8px;
      cursor: pointer;
      transition: 0.2s;
    }
    .user-avatar:hover {
      transform: scale(1.1);
      text-shadow: 0 0 30px cyan;
    }

    .user-name {
      font-size: 20px;
      font-weight: 700;
    }

    .user-email {
      font-size: 13px;
      color: #7fc9c9;
    }

    .signout-btn {
      background: transparent;
      border: 1px solid #ff7790;
      color: #ffb0c0;
      border-radius: 40px;
      padding: 12px;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.2s;
    }
    .signout-btn:hover {
      background: #ff4477;
      color: black;
      border-color: #ff4477;
    }

    .mode-switch {
      display: flex;
      background: rgba(0,30,40,0.7);
      border-radius: 60px;
      padding: 6px;
      border: 1px solid cyan;
      margin: 16px 0;
    }
    .mode-option {
      flex: 1;
      text-align: center;
      padding: 12px 0;
      border-radius: 40px;
      font-weight: 700;
      cursor: pointer;
      transition: 0.2s;
    }
    .mode-option.active {
      background: cyan;
      color: black;
      box-shadow: 0 0 15px cyan;
    }

    /* Feature panes */
    .feature-pane {
      display: none;
      animation: slideIn 0.3s ease;
    }
    .feature-pane.active-pane {
      display: block;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .card-header {
      font-size: 24px;
      font-weight: 700;
      color: #b3ffff;
      border-bottom: 1px solid rgba(0,255,255,0.2);
      padding-bottom: 16px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .btn {
      background: transparent;
      border: 1.5px solid cyan;
      color: cyan;
      padding: 12px 26px;
      border-radius: 40px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: 0.2s;
      margin: 8px 0;
    }
    .btn:hover {
      background: cyan;
      color: black;
      box-shadow: 0 0 25px cyan;
      transform: translateY(-2px);
    }

    /* Sliders, inputs, etc. */
    input, textarea, select {
      background: rgba(0, 30, 40, 0.7);
      border: 1.5px solid rgba(0,255,255,0.3);
      border-radius: 40px;
      padding: 14px 18px;
      font-size: 16px;
      color: white;
      outline: none;
      width: 100%;
      margin: 10px 0;
    }
    input:focus, textarea:focus, select:focus {
      border-color: cyan;
      box-shadow: 0 0 0 3px rgba(0,255,255,0.2);
    }

    /* Journal entries */
    .entries-container, .task-list {
      max-height: 300px;
      overflow-y: auto;
    }
    .entry {
      background: rgba(0,255,255,0.03);
      border: 1px solid rgba(0,255,255,0.2);
      border-radius: 20px;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      transition: 0.2s;
    }
    .entry:hover {
      background: rgba(0,255,255,0.08);
    }
    .delete-entry, .delete-task {
      color: #ff7790;
      cursor: pointer;
    }

    /* Grid for presets, etc. */
    .preset-grid, .theme-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 16px 0;
    }
    .preset-item, .theme-item, .integration-item {
      background: rgba(0,255,255,0.1);
      border: 1px solid cyan;
      border-radius: 40px;
      padding: 10px 22px;
      cursor: pointer;
      transition: 0.2s;
    }
    .preset-item:hover, .theme-item:hover, .integration-item:hover {
      background: cyan;
      color: black;
      transform: scale(1.05);
    }

    .analytics-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .analytics-card {
      background: rgba(0,30,40,0.7);
      border-radius: 32px;
      padding: 24px;
      text-align: center;
      border: 1px solid cyan;
    }

    /* Personalization */
    .avatar-options {
      display: flex;
      gap: 20px;
      justify-content: center;
      font-size: 48px;
      margin: 20px 0;
    }
    .avatar-options i {
      cursor: pointer;
      transition: 0.2s;
      color: cyan;
    }
    .avatar-options i:hover {
      transform: scale(1.2);
      text-shadow: 0 0 20px cyan;
    }

    /* Integrations */
    .integration-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px,1fr));
      gap: 16px;
      margin: 20px 0;
    }
    .integration-card {
      background: rgba(0,255,255,0.05);
      border-radius: 32px;
      padding: 24px 16px;
      text-align: center;
      border: 1px solid cyan;
      cursor: pointer;
      transition: 0.2s;
    }
    .integration-card:hover {
      background: cyan;
      color: black;
    }
    .integration-card i {
      font-size: 40px;
    }

    /* Developer panes */
    .node-editor {
      height: 200px;
      background: #0f202b;
      border-radius: 32px;
      border: 2px dashed cyan;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .api-key-demo {
      background: #0a1a22;
      padding: 20px;
      border-radius: 24px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <div id="appRoot"></div>

  <!-- AgentX Chat -->
  <script defer>
    document.body.appendChild(document.createElement('div')).setAttribute('id','chatBubbleRoot');
    window.agx = '6966b3b9ff2f8569ae243c64eqzJDjZgS87B5TfiPzQ+mw==|tIbVARHbb3vxisAHOtTxmc1gthpRt6O388wxaCp3rAA=';
  </script>
  <script defer src="https://storage.googleapis.com/agentx-cdn-01/agentx-chat.js"></script>

  <script type="module">
    // ==================== FIREBASE INIT ====================
    import { initializeApp } from "firebase/app";
    import { getAnalytics } from "firebase/analytics";
    import { 
      getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged 
    } from "firebase/auth";
    import { getFirestore, doc, setDoc, getDoc } from "firebase/firestore";

    const firebaseConfig = {
      apiKey: "AIzaSyAtUrEx-xIDqYZsIzWU-mG8_Fbc3s6D3Ic",
      authDomain: "nixai-d93cb.firebaseapp.com",
      projectId: "nixai-d93cb",
      storageBucket: "nixai-d93cb.firebasestorage.app",
      messagingSenderId: "120045328987",
      appId: "1:120045328987:web:01ab5651163b5c6c483d7e",
      measurementId: "G-4J7K0ZFMNT"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    // ==================== APP STATE ====================
    let currentUser = null;
    let onboardingCompleted = false;
    let activeFeature = 'journal';
    let currentMode = 'creator';
    let userProfile = { avatar: 'fas fa-circle-user', displayName: '', theme: 'dark' };

    // ==================== RENDER FUNCTIONS ====================
    const appRoot = document.getElementById('appRoot');

    function renderAuth() {
      appRoot.innerHTML = `
        <div class="auth-container">
          <div class="auth-header">
            <i class="fas fa-microchip"></i>
            <h2>Cyanix AI ¬∑ studio</h2>
            <p style="color:#9fc; margin:16px 0;">sign in with Google to continue</p>
          </div>
          <div class="google-btn" id="googleSignInBtn">
            <i class="fab fa-google"></i> Continue with Google
          </div>
        </div>
      `;
      document.getElementById('googleSignInBtn').addEventListener('click', () => {
        signInWithPopup(auth, provider).catch(alert);
      });
    }

    function renderOnboarding() {
      appRoot.innerHTML = `
        <div class="onboarding-container">
          <div class="onboarding-header">
            <i class="fas fa-pen-to-square"></i>
            <h2>Welcome, ${currentUser?.displayName || 'trailblazer'}</h2>
            <p style="color:#9cf; margin: 8px 0;">help us personalize your journey</p>
          </div>
          <div class="input-group">
            <label>Where did you hear about Cyanix AI?</label>
            <select id="q1">
              <option>Twitter / X</option>
              <option>LinkedIn</option>
              <option>GitHub</option>
              <option>Friend / colleague</option>
              <option>Other</option>
            </select>
          </div>
          <div class="input-group">
            <label>What is your primary role?</label>
            <select id="q2">
              <option>Developer</option>
              <option>Designer</option>
              <option>Product manager</option>
              <option>Researcher</option>
              <option>Student</option>
              <option>Other</option>
            </select>
          </div>
          <div class="input-group">
            <label>Why are you using Cyanix AI?</label>
            <select id="q3">
              <option>AI exploration</option>
              <option>Image / design work</option>
              <option>Code assistance</option>
              <option>Journaling & tasks</option>
              <option>All of the above</option>
            </select>
          </div>
          <div class="input-group">
            <label>How often do you plan to use it?</label>
            <select id="q4">
              <option>Daily</option>
              <option>Weekly</option>
              <option>Occasionally</option>
              <option>Just trying out</option>
            </select>
          </div>
          <button class="btn btn-block" id="submitOnboarding">Start exploring <i class="fas fa-rocket"></i></button>
        </div>
      `;
      document.getElementById('submitOnboarding').addEventListener('click', async () => {
        if (!currentUser) return;
        const answers = {
          q1: document.getElementById('q1').value,
          q2: document.getElementById('q2').value,
          q3: document.getElementById('q3').value,
          q4: document.getElementById('q4').value,
        };
        await setDoc(doc(db, 'users', currentUser.uid), { 
          onboarding: answers, 
          email: currentUser.email,
          profile: userProfile 
        });
        onboardingCompleted = true;
        renderDashboard();
      });
    }

    function renderDashboard() {
      appRoot.innerHTML = `
        <div class="dashboard">
          <!-- LEFT COLUMN (features) -->
          <div class="side-col left-col" id="leftCol"></div>

          <!-- CENTER COLUMN (active feature) -->
          <div class="center-col" id="centerPane"></div>

          <!-- RIGHT COLUMN (user + mode) -->
          <div class="side-col right-col" id="rightCol"></div>
        </div>
      `;

      // Build right column
      document.getElementById('rightCol').innerHTML = `
        <div class="user-card">
          <div class="user-avatar" id="avatarDisplay"><i class="${userProfile.avatar}"></i></div>
          <div class="user-name">${userProfile.displayName || currentUser?.displayName || 'Cyanix User'}</div>
          <div class="user-email">${currentUser?.email}</div>
          <div class="mode-switch" id="modeSwitch">
            <div class="mode-option ${currentMode === 'creator' ? 'active' : ''}" data-mode="creator">üü¢ Creator</div>
            <div class="mode-option ${currentMode === 'developer' ? 'active' : ''}" data-mode="developer">üîµ Developer</div>
          </div>
          <button class="signout-btn" id="signOutBtn"><i class="fas fa-sign-out-alt"></i> Sign out</button>
        </div>
        <div style="background: rgba(0,255,255,0.03); border-radius: 40px; padding: 24px;">
          <h4 style="color: cyan;"><i class="fas fa-bolt"></i> Quick actions</h4>
          <p style="color:#7bb2b2; margin-top:12px;">‚Ä¢ New journal entry</p>
          <p style="color:#7bb2b2;">‚Ä¢ Create Discord bot</p>
        </div>
      `;

      // Mode switching
      document.querySelectorAll('.mode-option').forEach(opt => {
        opt.addEventListener('click', (e) => {
          const mode = e.target.dataset.mode;
          if (mode === currentMode) return;
          currentMode = mode;
          document.querySelectorAll('.mode-option').forEach(el => el.classList.remove('active'));
          e.target.classList.add('active');
          buildLeftColumn();
          activeFeature = (mode === 'creator') ? 'journal' : 'modelLab';
          showFeature(activeFeature);
        });
      });

      // Sign out
      document.getElementById('signOutBtn').addEventListener('click', () => signOut(auth));

      // Build left column based on mode
      function buildLeftColumn() {
        const leftCol = document.getElementById('leftCol');
        if (currentMode === 'creator') {
          leftCol.innerHTML = `
            <div class="feature-btn active" data-feature="journal"><i class="fas fa-book-open"></i> Journal</div>
            <div class="feature-btn" data-feature="tasks"><i class="fas fa-list-check"></i> Task Forge</div>
            <div class="feature-btn" data-feature="image"><i class="fas fa-image"></i> Image Editor</div>
            <div class="feature-btn" data-feature="code"><i class="fas fa-code"></i> Code Builder</div>
            <div class="feature-btn" data-feature="aiAppBuilder"><i class="fas fa-bolt"></i> AI App Builder</div>
            <div class="feature-btn" data-feature="promptPlayground"><i class="fas fa-pen-to-square"></i> Prompt Playground</div>
            <div class="feature-btn" data-feature="analytics"><i class="fas fa-chart-simple"></i> Analytics</div>
            <div class="feature-btn" data-feature="personalize"><i class="fas fa-palette"></i> Personalize</div>
            <div class="feature-btn" data-feature="integrations"><i class="fas fa-plug"></i> Integrations</div>
          `;
        } else {
          leftCol.innerHTML = `
            <div class="feature-btn active" data-feature="modelLab"><i class="fas fa-flask"></i> Model Lab</div>
            <div class="feature-btn" data-feature="apiManager"><i class="fas fa-key"></i> API Manager</div>
            <div class="feature-btn" data-feature="logicBuilder"><i class="fas fa-diagram-project"></i> Logic Builder</div>
            <div class="feature-btn" data-feature="sandbox"><i class="fas fa-vial"></i> Sandbox</div>
            <div class="feature-btn" data-feature="integrations"><i class="fas fa-plug"></i> Integrations</div>
          `;
        }
        document.querySelectorAll('.feature-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('.feature-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            activeFeature = btn.dataset.feature;
            showFeature(activeFeature);
          });
        });
      }

      buildLeftColumn();
      showFeature(activeFeature);
    }

    function showFeature(feature) {
      const center = document.getElementById('centerPane');
      if (!center) return;

      const panes = {
        journal: getJournalPane(),
        tasks: getTasksPane(),
        image: getImagePane(),
        code: getCodePane(),
        aiAppBuilder: getAiAppBuilderPane(),
        promptPlayground: getPromptPlaygroundPane(),
        analytics: getAnalyticsPane(),
        personalize: getPersonalizePane(),
        integrations: getIntegrationsPane(),
        modelLab: getModelLabPane(),
        apiManager: getApiManagerPane(),
        logicBuilder: getLogicBuilderPane(),
        sandbox: getSandboxPane()
      };

      center.innerHTML = panes[feature] || '<p>Select a feature</p>';
      // Initialize feature functionality
      if (feature === 'journal') initJournal();
      if (feature === 'tasks') initTasks();
      if (feature === 'image') initImageEditor();
      if (feature === 'code') initCodeBuilder();
      if (feature === 'aiAppBuilder') initAiAppBuilder();
      if (feature === 'promptPlayground') initPromptPlayground();
      if (feature === 'analytics') initAnalytics();
      if (feature === 'personalize') initPersonalize();
      if (feature === 'integrations') initIntegrations();
      if (feature === 'modelLab') initModelLab();
      if (feature === 'apiManager') initApiManager();
      if (feature === 'logicBuilder') initLogicBuilder();
      if (feature === 'sandbox') initSandbox();
    }

    // ---------- Feature pane HTML generators (with interactive elements) ----------
    function getJournalPane() {
      return `
        <div class="feature-pane active-pane" id="journalPane">
          <div class="card-header"><i class="fas fa-book-open"></i> Cyanix Journal</div>
          <textarea id="journalInput" placeholder="Record your thoughts..."></textarea>
          <button class="btn" id="addEntryBtn"><i class="fas fa-pen-fancy"></i> Add Entry</button>
          <div id="journalEntries" class="entries-container"></div>
        </div>
      `;
    }

    function getTasksPane() {
      return `
        <div class="feature-pane" id="tasksPane">
          <div class="card-header"><i class="fas fa-list-check"></i> Task Forge</div>
          <input type="text" id="taskInput" placeholder="Add new task ...">
          <button class="btn" id="addTaskBtn"><i class="fas fa-plus-circle"></i> Create Task</button>
          <ul id="taskList" class="task-list"></ul>
        </div>
      `;
    }

    function getImagePane() {
      return `
        <div class="feature-pane" id="imagePane">
          <div class="card-header"><i class="fas fa-image"></i> Image Editor</div>
          <div class="image-editor">
            <div class="image-canvas" id="imageCanvas" style="height:200px; background:#11212e; border-radius:32px; display:flex; align-items:center; justify-content:center;">
              <i class="fas fa-cloud-upload-alt" style="font-size:40px;"></i> <span>click to simulate upload</span>
            </div>
            <div class="img-controls" style="margin-top:16px;">
              <button class="btn" id="grayscaleBtn"><i class="fas fa-droplet"></i> Grayscale</button>
              <button class="btn" id="brightnessBtn"><i class="fas fa-sun"></i> Brightness +</button>
              <button class="btn" id="resetImgBtn"><i class="fas fa-undo"></i> Reset</button>
            </div>
          </div>
        </div>
      `;
    }

    function getCodePane() {
      return `
        <div class="feature-pane" id="codePane">
          <div class="card-header"><i class="fas fa-code"></i> Python Playground</div>
          <textarea id="codeInput" style="height:150px; font-family:monospace;" placeholder="# write your python code here...\nprint('hello cyanix')"></textarea>
          <button class="btn" id="runCodeBtn"><i class="fas fa-play"></i> Run</button>
          <div id="codeOutput" style="background:#0a1a22; border-radius:24px; padding:20px; margin-top:16px;">‚Ä∫ output will appear here</div>
        </div>
      `;
    }

    function getAiAppBuilderPane() {
      return `
        <div class="feature-pane" id="aiAppBuilderPane">
          <div class="card-header"><i class="fas fa-bolt"></i> AI App Builder</div>
          <div>
            <label>Personality preset</label>
            <div class="preset-grid">
              <div class="preset-item" data-preset="friendly">Friendly</div>
              <div class="preset-item" data-preset="professional">Professional</div>
              <div class="preset-item" data-preset="sarcastic">Sarcastic</div>
            </div>
          </div>
          <div>
            <label>Memory</label>
            <div style="display:flex; gap:10px;">
              <button class="btn" id="shortMem">Short-term</button>
              <button class="btn" id="longMem">Long-term</button>
            </div>
          </div>
          <div>
            <label>Theme</label>
            <div class="theme-grid">
              <div class="theme-item" data-theme="dark">Dark</div>
              <div class="theme-item" data-theme="light">Light</div>
              <div class="theme-item" data-theme="cyan">Cyan</div>
            </div>
          </div>
          <button class="btn" id="deployBtn"><i class="fas fa-rocket"></i> Deploy</button>
          <p id="deployStatus" style="color:#3eaeae; margin-top:16px;"></p>
        </div>
      `;
    }

    function getPromptPlaygroundPane() {
      return `
        <div class="feature-pane" id="promptPlaygroundPane">
          <div class="card-header"><i class="fas fa-pen-to-square"></i> Prompt Playground</div>
          <textarea id="promptInput" placeholder="Enter your prompt..." style="height:120px;"></textarea>
          <div class="slider-group">
            <div class="slider-label"><span>Creativity</span><span id="creativityVal">0.7</span></div>
            <input type="range" id="creativitySlider" min="0" max="1" step="0.1" value="0.7">
          </div>
          <div class="slider-group">
            <div class="slider-label"><span>Response length</span><span id="lengthVal">150</span></div>
            <input type="range" id="lengthSlider" min="50" max="500" step="10" value="150">
          </div>
          <select id="toneSelect">
            <option>Neutral</option>
            <option>Formal</option>
            <option>Casual</option>
          </select>
          <button class="btn" id="saveTemplateBtn"><i class="fas fa-save"></i> Save as template</button>
          <div id="templateMessage" style="margin-top:16px;"></div>
        </div>
      `;
    }

    function getAnalyticsPane() {
      return `
        <div class="feature-pane" id="analyticsPane">
          <div class="card-header"><i class="fas fa-chart-simple"></i> Simple Analytics</div>
          <div class="analytics-cards">
            <div class="analytics-card"><i class="fas fa-comments"></i><h3>1.2k</h3><p>Conversations</p></div>
            <div class="analytics-card"><i class="fas fa-user-plus"></i><h3>342</h3><p>User growth</p></div>
            <div class="analytics-card"><i class="fas fa-cloud-arrow-up"></i><h3>8.4k</h3><p>API usage</p></div>
            <div class="analytics-card"><i class="fas fa-clock"></i><h3>4.2m</h3><p>Engagement time</p></div>
          </div>
        </div>
      `;
    }

    function getPersonalizePane() {
      return `
        <div class="feature-pane" id="personalizePane">
          <div class="card-header"><i class="fas fa-palette"></i> Personalize</div>
          <div style="text-align:center;">
            <div class="user-avatar" style="font-size:100px;"><i class="${userProfile.avatar}"></i></div>
            <div class="avatar-options">
              <i class="fas fa-circle-user" data-avatar="fas fa-circle-user"></i>
              <i class="fas fa-robot" data-avatar="fas fa-robot"></i>
              <i class="fas fa-cat" data-avatar="fas fa-cat"></i>
              <i class="fas fa-dragon" data-avatar="fas fa-dragon"></i>
            </div>
          </div>
          <div class="input-group">
            <label>Display name</label>
            <input type="text" id="displayNameInput" value="${userProfile.displayName || ''}">
          </div>
          <div class="input-group">
            <label>Theme</label>
            <select id="themeSelect">
              <option value="dark" ${userProfile.theme === 'dark' ? 'selected' : ''}>Dark</option>
              <option value="light" ${userProfile.theme === 'light' ? 'selected' : ''}>Light</option>
              <option value="cyan" ${userProfile.theme === 'cyan' ? 'selected' : ''}>Cyan</option>
            </select>
          </div>
          <button class="btn" id="saveProfileBtn"><i class="fas fa-save"></i> Save Changes</button>
        </div>
      `;
    }

    function getIntegrationsPane() {
      return `
        <div class="feature-pane" id="integrationsPane">
          <div class="card-header"><i class="fas fa-plug"></i> Integrations</div>
          <div class="integration-grid">
            <div class="integration-card" data-integration="discord">
              <i class="fab fa-discord"></i>
              <h4>Discord Bot</h4>
              <p>Create & deploy</p>
            </div>
            <div class="integration-card" data-integration="slack">
              <i class="fab fa-slack"></i>
              <h4>Slack App</h4>
              <p>Configure</p>
            </div>
            <div class="integration-card" data-integration="twitter">
              <i class="fab fa-twitter"></i>
              <h4>Twitter Bot</h4>
              <p>Auto‚Äëpost</p>
            </div>
            <div class="integration-card" data-integration="github">
              <i class="fab fa-github"></i>
              <h4>GitHub Action</h4>
              <p>CI/CD</p>
            </div>
          </div>
          <div id="integrationDetails" style="margin-top:24px;"></div>
        </div>
      `;
    }

    function getModelLabPane() {
      return `
        <div class="feature-pane" id="modelLabPane">
          <div class="card-header"><i class="fas fa-flask"></i> Model Lab</div>
          <button class="btn" id="uploadDatasetBtn"><i class="fas fa-upload"></i> Upload dataset</button>
          <button class="btn" id="viewTokenizerBtn"><i class="fas fa-eye"></i> Tokenizer viewer</button>
          <div style="background:#0f202b; border-radius:24px; padding:20px; margin:16px 0;">
            <p>Loss graph (demo)</p>
            <div style="height:80px; display:flex; align-items:flex-end; gap:4px;">
              <div style="width:20%; background:cyan; height:40%;"></div>
              <div style="width:20%; background:cyan; height:70%;"></div>
              <div style="width:20%; background:cyan; height:30%;"></div>
              <div style="width:20%; background:cyan; height:90%;"></div>
            </div>
          </div>
          <div>Version: v2.3.1</div>
        </div>
      `;
    }

    function getApiManagerPane() {
      return `
        <div class="feature-pane" id="apiManagerPane">
          <div class="card-header"><i class="fas fa-key"></i> API Manager</div>
          <div class="api-key-demo">api_live_cynx_xxxxxxxxxxxx</div>
          <button class="btn" id="generateKeyBtn"><i class="fas fa-rotate"></i> Generate new key</button>
          <div style="margin-top:16px;">
            <label>Rate limit: <span id="rateValue">1000</span>/min</label>
            <input type="range" id="rateSlider" min="100" max="5000" value="1000">
          </div>
        </div>
      `;
    }

    function getLogicBuilderPane() {
      return `
        <div class="feature-pane" id="logicBuilderPane">
          <div class="card-header"><i class="fas fa-diagram-project"></i> Logic Builder</div>
          <div class="node-editor">
            <i class="fas fa-arrows-up-down-left-right" style="font-size:32px;"></i> Drag & drop nodes
          </div>
          <button class="btn" id="connectFirebaseBtn"><i class="fas fa-database"></i> Connect Firebase</button>
        </div>
      `;
    }

    function getSandboxPane() {
      return `
        <div class="feature-pane" id="sandboxPane">
          <div class="card-header"><i class="fas fa-vial"></i> Sandbox</div>
          <div style="display:flex; gap:10px;">
            <button class="btn" id="simulateUsersBtn"><i class="fas fa-users"></i> Simulate 100 users</button>
            <button class="btn" id="loadTestBtn"><i class="fas fa-chart-line"></i> Load test</button>
          </div>
          <div style="background:#0f202b; border-radius:24px; padding:16px; margin-top:16px;">
            <pre id="debugConsole">> ready</pre>
          </div>
        </div>
      `;
    }

    // ---------- Feature initializers (fully interactive) ----------
    function initJournal() {
      const input = document.getElementById('journalInput');
      const addBtn = document.getElementById('addEntryBtn');
      const container = document.getElementById('journalEntries');
      if (!container) return;
      const addEntry = (text) => {
        if (!text.trim()) return;
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `<span class="entry-text">${text}</span>
          <span class="entry-time">${new Date().toLocaleTimeString()}</span>
          <i class="fas fa-trash delete-entry"></i>`;
        container.appendChild(div);
      };
      container.innerHTML = '';
      addEntry('Designed Cyanix glass UI');
      addEntry('AI chat responding fluidly');
      addBtn?.addEventListener('click', () => { addEntry(input.value); input.value = ''; });
      container.addEventListener('click', (e) => {
        if (e.target.classList.contains('delete-entry')) e.target.closest('.entry').remove();
      });
    }

    function initTasks() {
      const input = document.getElementById('taskInput');
      const addBtn = document.getElementById('addTaskBtn');
      const list = document.getElementById('taskList');
      if (!list) return;
      const addTask = (text) => {
        if (!text.trim()) return;
        const li = document.createElement('li');
        li.innerHTML = `<input type="checkbox"><span class="task-text">${text}</span><i class="fas fa-trash delete-task"></i>`;
        list.appendChild(li);
      };
      list.innerHTML = '';
      addTask('Implement journal delete');
      addTask('Finish cyan neon hover states');
      addBtn?.addEventListener('click', () => { addTask(input.value); input.value = ''; });
      list.addEventListener('click', (e) => {
        if (e.target.classList.contains('delete-task')) e.target.closest('li').remove();
      });
      list.addEventListener('change', (e) => {
        if (e.target.type === 'checkbox') e.target.nextElementSibling.classList.toggle('completed', e.target.checked);
      });
    }

    function initImageEditor() {
      const canvas = document.getElementById('imageCanvas');
      if (!canvas) return;
      canvas.addEventListener('click', () => {
        canvas.style.background = '#1a3a4a';
        canvas.innerHTML = '<i class="fas fa-check" style="color:cyan;"></i> Image loaded (simulated)';
      });
      document.getElementById('grayscaleBtn')?.addEventListener('click', () => canvas.style.filter = 'grayscale(1)');
      document.getElementById('brightnessBtn')?.addEventListener('click', () => canvas.style.filter = 'brightness(1.5)');
      document.getElementById('resetImgBtn')?.addEventListener('click', () => canvas.style.filter = 'none');
    }

    function initCodeBuilder() {
      const runBtn = document.getElementById('runCodeBtn');
      const codeInput = document.getElementById('codeInput');
      const output = document.getElementById('codeOutput');
      runBtn?.addEventListener('click', () => {
        output.innerText = `>>> ${codeInput.value}\n[simulated] Hello, Cyanix coder!`;
      });
    }

    function initAiAppBuilder() {
      document.querySelectorAll('.preset-item').forEach(el => {
        el.addEventListener('click', () => alert(`Preset: ${el.dataset.preset} (demo)`));
      });
      document.getElementById('shortMem')?.addEventListener('click', () => alert('Short-term memory enabled'));
      document.getElementById('longMem')?.addEventListener('click', () => alert('Long-term memory enabled'));
      document.querySelectorAll('.theme-item').forEach(el => {
        el.addEventListener('click', () => alert(`Theme: ${el.dataset.theme}`));
      });
      document.getElementById('deployBtn')?.addEventListener('click', () => {
        document.getElementById('deployStatus').innerText = '‚úÖ App deployed instantly!';
      });
    }

    function initPromptPlayground() {
      const creativity = document.getElementById('creativitySlider');
      const length = document.getElementById('lengthSlider');
      const creativityVal = document.getElementById('creativityVal');
      const lengthVal = document.getElementById('lengthVal');
      creativity?.addEventListener('input', () => creativityVal.innerText = creativity.value);
      length?.addEventListener('input', () => lengthVal.innerText = length.value);
      document.getElementById('saveTemplateBtn')?.addEventListener('click', () => {
        document.getElementById('templateMessage').innerHTML = '‚úÖ Template saved!';
      });
    }

    function initAnalytics() { /* static */ }

    function initPersonalize() {
      document.querySelectorAll('.avatar-options i').forEach(el => {
        el.addEventListener('click', () => {
          userProfile.avatar = el.dataset.avatar;
          document.querySelector('#personalizePane .user-avatar i').className = userProfile.avatar;
          document.getElementById('avatarDisplay').innerHTML = `<i class="${userProfile.avatar}"></i>`;
        });
      });
      document.getElementById('saveProfileBtn')?.addEventListener('click', () => {
        userProfile.displayName = document.getElementById('displayNameInput').value;
        userProfile.theme = document.getElementById('themeSelect').value;
        alert('Profile updated (demo)');
      });
    }

    function initIntegrations() {
      document.querySelectorAll('.integration-card').forEach(card => {
        card.addEventListener('click', () => {
          const type = card.dataset.integration;
          let msg = '';
          if (type === 'discord') msg = 'üéÆ Discord bot creator: choose a name for your bot.';
          else if (type === 'slack') msg = 'üí¨ Slack app configuration wizard (demo).';
          else if (type === 'twitter') msg = 'üê¶ Twitter bot scheduler (demo).';
          else if (type === 'github') msg = 'üêô GitHub Action template generated.';
          document.getElementById('integrationDetails').innerHTML = `<div class="api-key-demo">${msg}</div>`;
        });
      });
    }

    function initModelLab() {
      document.getElementById('uploadDatasetBtn')?.addEventListener('click', () => alert('Dataset upload UI (demo)'));
      document.getElementById('viewTokenizerBtn')?.addEventListener('click', () => alert('Tokenizer viewer: <PAD>, <UNK>, ...'));
    }

    function initApiManager() {
      document.getElementById('generateKeyBtn')?.addEventListener('click', () => {
        document.querySelector('.api-key-demo').innerText = 'api_live_newkey_' + Math.random().toString(36).substring(2);
      });
      const slider = document.getElementById('rateSlider');
      const rateVal = document.getElementById('rateValue');
      slider?.addEventListener('input', () => rateVal.innerText = slider.value);
    }

    function initLogicBuilder() {
      document.getElementById('connectFirebaseBtn')?.addEventListener('click', () => alert('Firebase connected (demo)'));
    }

    function initSandbox() {
      document.getElementById('simulateUsersBtn')?.addEventListener('click', () => {
        document.getElementById('debugConsole').innerText = '> Simulating 100 users... done.';
      });
      document.getElementById('loadTestBtn')?.addEventListener('click', () => {
        document.getElementById('debugConsole').innerText = '> Load test: 950 req/sec, 0 errors.';
      });
    }

    // ==================== AUTH STATE OBSERVER ====================
    onAuthStateChanged(auth, async (user) => {
      currentUser = user;
      if (user) {
        const docRef = doc(db, 'users', user.uid);
        const docSnap = await getDoc(docRef);
        if (docSnap.exists() && docSnap.data().onboarding) {
          onboardingCompleted = true;
          userProfile = { ...userProfile, ...docSnap.data().profile };
          renderDashboard();
        } else {
          renderOnboarding();
        }
      } else {
        renderAuth();
      }
    });

    renderAuth(); // start
  </script>
</body>
</html>